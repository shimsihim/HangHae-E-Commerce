# e-Commerce 주문 서비스 요구사항 정의서

## 목차
1. [기능적 요구사항](#기능적-요구사항)
   - [유저](#유저)
   - [상품](#상품)
   - [장바구니](#장바구니)
   - [쿠폰 관리](#쿠폰-관리)
   - [재고 관리](#재고-관리)
   - [주문 및 결제](#주문-및-결제)
2. [비기능적 요구사항](#비기능적-요구사항)

---

## 기능적 요구사항

### 유저

| 요구사항명 | 기능명    | 상세설명                                                                                 | 필수 데이터        | 선택 데이터 |
|:-----:|:------:|:------------------------------------------------------------------------------------:|:--------------:|:------:|
| 로그인   | 자체 로그인 | 서비스 내 아이디와 비밀번호를 통해 로그인할 수 있다.                                                       | 아이디, 비밀번호     |        |
| 포인트   | 충전     | 포인트를 충전할 수 있다. (1회 충전 금액은 최대 50만원을 넘을 수 없다.) (충전 후 총 금액은 1,000,000,000을 넘을 수 없다.) | 유저 ID, 충전량 (>0) |        |
| 포인트   | 사용     | 포인트를 사용할 수 있다. (사용 금액은 보유 금액을 넘을 수 없다.)                                              | 유저 ID, 사용량 (>0) |        |
| 포인트   | 동시성 제어 | 같은 사용자에 대해 동시에 여러 건의 충전 및 사용 요청이 들어와도 정확하게 반영되어야 한다.                                 |                |        |
| 포인트   | 기록     | 포인트 사용 및 충전 시 해당 내역은 모두 기록되어야 한다.                                                   |                |        |
| 포인트   | 조회     | 사용자는 자신의 잔여 포인트를 확인할 수 있어야 한다.                                                      | 유저 ID          |        |
| 포인트   | 이력 조회  | 사용자는 자신의 포인트 이력을 조회할 수 있어야 한다.                                                      | 유저 ID          |        |

### 상품

| 요구사항명 | 기능명      |                                             상세설명                                             | 필수 데이터 | 선택 데이터                                                    |
|:-----:|:--------:|:--------------------------------------------------------------------------------------------:|:------:|:---------------------------------------------------------:|
| 상품    | 상품 목록 조회 | 사용자는 상품 목록을 조회할 수 있다. (금액순, 최신순, 인기순 등의 정렬이 가능하다)<br>인기순 정렬 시 최근 N일(기본 7일) 내 판매량을 기준으로 정렬한다. |        | 정렬 조건: 금액 오름차순, 금액 내림차순, 최신순, 인기순<br>인기순 조회 기간: N일(기본 3일) |
| 상품    | 상품 상세 조회 |                     사용자는 상품 목록에서 특정 상품 클릭 시 해당 상품의 상세 설명, 옵션을 조회할 수 있다.                      | 상품 ID  |                                                           |

### 장바구니

| 요구사항명 | 기능명        | 상세설명                                                                         | 필수 데이터                 | 선택 데이터 |
|:-----:|:----------:|:----------------------------------------------------------------------------:|:-----------------------:|:------:|
| 장바구니  | 장바구니 추가    | 사용자는 선택한 상품의 옵션을 장바구니에 추가할 수 있다. (이미 존재하는 옵션은 수량이 추가되며, 여러 옵션 동시 선택 가능) | 유저 ID, 상품 옵션 ID, 수량    |        |
| 장바구니  | 장바구니 조회    | 사용자는 장바구니 목록을 조회할 수 있다. (품절 상품 포함)                                          | 유저 ID                   |        |
| 장바구니  | 장바구니 수량 조절 | 사용자는 장바구니 목록에서 추가된 옵션의 수량을 제어할 수 있다.                                        | 유저 ID, 장바구니 항목 ID, 수량 |        |
| 장바구니  | 장바구니 삭제    | 사용자는 장바구니에서 특정 항목을 삭제할 수 있다.                                                | 유저 ID, 장바구니 항목 ID      |        |

### 쿠폰 관리

| 요구사항명 | 기능명       | 상세설명                                                                         | 필수 데이터      | 선택 데이터 |
|:-----:|:---------:|:----------------------------------------------------------------------------:|:------------:|:------:|
| 쿠폰    | 쿠폰 발급     | 시스템은 선착순으로 쿠폰을 발급해야 하며, 발급 가능 수량 초과 시 발급에 실패해야 한다. (1인 1개 제한)              | 유저 ID, 쿠폰 ID |        |
| 쿠폰    | 동시성 제어    | 대량의 쿠폰 발급 요청이 동시에 발생해도 발급 가능 수량을 초과하지 않아야 한다.                                |              |        |
| 쿠폰    | 쿠폰 조회     | 사용자는 자신이 발급받은 쿠폰 목록을 조회할 수 있다.                                                | 유저 ID        |        |
| 쿠폰    | 쿠폰 사용     | 사용자는 자신이 발급받은 쿠폰을 주문 시 사용할 수 있다. 이때 할인율에 따라 금액을 할인한다.                        | 유저 쿠폰 ID    |        |
| 쿠폰    | 쿠폰 유효성 검증 | 시스템은 쿠폰 발급 및 사용 시 쿠폰의 유효성을 검증해야 한다. (유효기한, 사용여부, 소유여부, 중복 발급 여부)          |              |        |

### 재고 관리

| 요구사항명 | 기능명    | 상세설명                             | 필수 데이터       | 선택 데이터 |
|:-----:|:------:|:--------------------------------:|:-------------:|:------:|
| 재고    | 재고 조회  | 사용자는 상품의 실시간 재고 수량을 확인할 수 있어야 한다.    | 상품 옵션 ID     |        |
| 재고    | 재고 차감  | 결제 완료 시 재고를 차감해야 한다.               | 상품 옵션 ID, 수량 |        |
| 재고    | 재고 복구  | 주문 취소 및 결제 실패 시 재고를 복구해야 한다.       | 상품 옵션 ID, 수량 |        |
| 재고    | 동시성 제어 | 동시에 발생하는 주문에 대해 재고 차감이 정확하게 처리되어야 한다. |               |        |


### 주문 및 결제

| 요구사항명 | 기능명         | 상세설명                                                  | 필수 데이터                  | 선택 데이터  |
|:-----:|:-----------:|:-----------------------------------------------------:|:------------------------:|:-------:|
| 주문    | 주문 생성       | 사용자는 주문을 생성할 수 있다. (재고 검증 포함, 주문 상태: PENDING)        | 유저 ID, 상품 옵션들 및 각각의 수량 |         |
| 결제    | 결제          | 사용자는 자신의 포인트를 사용하여 주문을 결제 완료할 수 있다. (주문 상태: PAID) | 유저 ID, 주문 ID            | 유저 쿠폰 ID |
| 결제    | 결제 실패 처리    | 포인트 부족 또는 재고 부족 시 결제가 실패하며 주문 상태는 PENDING으로 유지된다.    |                          |         |
| 주문    | 주문 내역 조회    | 사용자는 주문 내역을 조회할 수 있다.                                 | 유저 ID                    |         |
| 주문    | 주문 상세 내역 조회 | 사용자는 주문 상세 내역을 조회할 수 있다.                              | 유저 ID, 주문 ID            |         |

---

## 비기능적 요구사항

### 신뢰성

| 항목      | 요구사항                                              |
|---------|---------------------------------------------------|
| 데이터 정합성 | 동시성 제어가 필요한 작업(재고 차감, 포인트 사용, 쿠폰 발급)에서 데이터 정합성을 보장해야 한다. |
| 트랜잭션 일관성| 주문 및 결제 프로세스에서 트랜잭션 일관성을 유지해야 한다.                 |

### 확장성

| 항목    | 요구사항                                 |
|-------|--------------------------------------|
| 수평 확장 | 애플리케이션 서버는 수평 확장이 가능해야 한다.           |
| 메시지 큐 | 추후 Kafka 등의 메시지 큐 전환이 용이하도록 설계해야 한다. |

